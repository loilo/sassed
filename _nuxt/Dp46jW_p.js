var S=Object.defineProperty;var v=(n,r)=>S(n,"name",{value:r,configurable:!0});try{self["workbox:window:7.3.0"]&&_()}catch{}function P(n,r){return new Promise((function(t){var o=new MessageChannel;o.port1.onmessage=function(f){t(f.data)},n.postMessage(r,[o.port2])}))}v(P,"n");function E(n,r){(r==null||r>n.length)&&(r=n.length);for(var t=0,o=Array(r);t<r;t++)o[t]=n[t];return o}v(E,"t");function W(n,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,L(o.key),o)}}v(W,"r");function k(n,r){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t)return(t=t.call(n)).next.bind(t);if(Array.isArray(n)||(t=(function(f,c){if(f){if(typeof f=="string")return E(f,c);var a={}.toString.call(f).slice(8,-1);return a==="Object"&&f.constructor&&(a=f.constructor.name),a==="Map"||a==="Set"?Array.from(f):a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?E(f,c):void 0}})(n))||r){t&&(n=t);var o=0;return function(){return o>=n.length?{done:!0}:{done:!1,value:n[o++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}v(k,"e");function b(n,r){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,o){return t.__proto__=o,t},b(n,r)}v(b,"i");function L(n){var r=(function(t,o){if(typeof t!="object"||!t)return t;var f=t[Symbol.toPrimitive];if(f!==void 0){var c=f.call(t,o);if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)})(n,"string");return typeof r=="symbol"?r:r+""}v(L,"o");try{self["workbox:core:7.3.0"]&&_()}catch{}var y=v(function(){var n=this;this.promise=new Promise((function(r,t){n.resolve=r,n.reject=t}))},"u");function w(n,r){var t=location.href;return new URL(n,t).href===new URL(r,t).href}v(w,"a");var p=v(function(n,r){this.type=n,Object.assign(this,r)},"c");function h(n,r,t){return t?r?r(n):n:(n&&n.then||(n=Promise.resolve(n)),r?n.then(r):n)}v(h,"f");function O(){}v(O,"s");var x={type:"SKIP_WAITING"};function j(n,r){return n&&n.then?n.then(O):Promise.resolve()}v(j,"h");var A=(function(n){function r(c,a){var e,i;return a===void 0&&(a={}),(e=n.call(this)||this).nn={},e.tn=0,e.rn=new y,e.en=new y,e.on=new y,e.un=0,e.an=new Set,e.cn=function(){var u=e.fn,s=u.installing;e.tn>0||!w(s.scriptURL,e.sn.toString())||performance.now()>e.un+6e4?(e.vn=s,u.removeEventListener("updatefound",e.cn)):(e.hn=s,e.an.add(s),e.rn.resolve(s)),++e.tn,s.addEventListener("statechange",e.ln)},e.ln=function(u){var s=e.fn,l=u.target,d=l.state,g=l===e.vn,m={sw:l,isExternal:g,originalEvent:u};!g&&e.mn&&(m.isUpdate=!0),e.dispatchEvent(new p(d,m)),d==="installed"?e.wn=self.setTimeout((function(){d==="installed"&&s.waiting===l&&e.dispatchEvent(new p("waiting",m))}),200):d==="activating"&&(clearTimeout(e.wn),g||e.en.resolve(l))},e.yn=function(u){var s=e.hn,l=s!==navigator.serviceWorker.controller;e.dispatchEvent(new p("controlling",{isExternal:l,originalEvent:u,sw:s,isUpdate:e.mn})),l||e.on.resolve(s)},e.gn=(i=v(function(u){var s=u.data,l=u.ports,d=u.source;return h(e.getSW(),(function(){e.an.has(d)&&e.dispatchEvent(new p("message",{data:s,originalEvent:u,ports:l,sw:d}))}))},"i"),function(){for(var u=[],s=0;s<arguments.length;s++)u[s]=arguments[s];try{return Promise.resolve(i.apply(this,u))}catch(l){return Promise.reject(l)}}),e.sn=c,e.nn=a,navigator.serviceWorker.addEventListener("message",e.gn),e}v(r,"e");var t,o;o=n,(t=r).prototype=Object.create(o.prototype),t.prototype.constructor=t,b(t,o);var f=r.prototype;return f.register=function(c){var a=(c===void 0?{}:c).immediate,e=a!==void 0&&a;try{var i=this;return h((function(u,s){var l=u();return l&&l.then?l.then(s):s(l)})((function(){if(!e&&document.readyState!=="complete")return j(new Promise((function(u){return window.addEventListener("load",u)})))}),(function(){return i.mn=!!navigator.serviceWorker.controller,i.dn=i.pn(),h(i.bn(),(function(u){i.fn=u,i.dn&&(i.hn=i.dn,i.en.resolve(i.dn),i.on.resolve(i.dn),i.dn.addEventListener("statechange",i.ln,{once:!0}));var s=i.fn.waiting;return s&&w(s.scriptURL,i.sn.toString())&&(i.hn=s,Promise.resolve().then((function(){i.dispatchEvent(new p("waiting",{sw:s,wasWaitingBeforeRegister:!0}))})).then((function(){}))),i.hn&&(i.rn.resolve(i.hn),i.an.add(i.hn)),i.fn.addEventListener("updatefound",i.cn),navigator.serviceWorker.addEventListener("controllerchange",i.yn),i.fn}))})))}catch(u){return Promise.reject(u)}},f.update=function(){try{return this.fn?h(j(this.fn.update())):h()}catch(c){return Promise.reject(c)}},f.getSW=function(){return this.hn!==void 0?Promise.resolve(this.hn):this.rn.promise},f.messageSW=function(c){try{return h(this.getSW(),(function(a){return P(a,c)}))}catch(a){return Promise.reject(a)}},f.messageSkipWaiting=function(){this.fn&&this.fn.waiting&&P(this.fn.waiting,x)},f.pn=function(){var c=navigator.serviceWorker.controller;return c&&w(c.scriptURL,this.sn.toString())?c:void 0},f.bn=function(){try{var c=this;return h((function(a,e){try{var i=a()}catch(u){return e(u)}return i&&i.then?i.then(void 0,e):i})((function(){return h(navigator.serviceWorker.register(c.sn,c.nn),(function(a){return c.un=performance.now(),a}))}),(function(a){throw a})))}catch(a){return Promise.reject(a)}},(function(c,a,e){return a&&W(c.prototype,a),Object.defineProperty(c,"prototype",{writable:!1}),c})(r,[{key:"active",get:v(function(){return this.en.promise},"get")},{key:"controlling",get:v(function(){return this.on.promise},"get")}])})((function(){function n(){this.Pn=new Map}v(n,"n");var r=n.prototype;return r.addEventListener=function(t,o){this.jn(t).add(o)},r.removeEventListener=function(t,o){this.jn(t).delete(o)},r.dispatchEvent=function(t){t.target=this;for(var o,f=k(this.jn(t.type));!(o=f()).done;)(0,o.value)(t)},r.jn=function(t){return this.Pn.has(t)||this.Pn.set(t,new Set),this.Pn.get(t)},n})());export{A as Workbox,p as WorkboxEvent,P as messageSW};
